import{r as o,u as P,j as e,B as l,P as L,I as r,D as y,a as E,b as N,c as w,d as I,e as M}from"./index-B7iLIyza.js";function B(){const[p,D]=o.useState([]),[h,j]=o.useState([]),{toast:i}=P(),[C,g]=o.useState(!1),[S,m]=o.useState(!1),[c,v]=o.useState(""),[d,f]=o.useState(""),[s,n]=o.useState({id:"",category:"",amount:"",date:new Date().toISOString().split("T")[0],description:""});o.useEffect(()=>{x()},[]),o.useEffect(()=>{if(!p.length)return;if(!c&&!d){j(p);return}const t=p.filter(a=>{const u=new Date(a.date);return c&&d?u>=new Date(c)&&u<=new Date(d):c?u>=new Date(c):d?u<=new Date(d):!0});j(t)},[p,c,d]);const x=async()=>{try{const t=await fetch("/api/financials/expenses");if(!t.ok)throw new Error("Failed to fetch expenses");const a=await t.json();D(a)}catch{i({title:"Error",description:"Failed to fetch expenses data",variant:"destructive"})}},b=t=>{n({id:t.id.toString(),category:t.category,amount:t.amount.toString(),date:t.date,description:t.description||""}),m(!0)},k=async t=>{try{(await fetch(`/api/financials/expenses/${t}`,{method:"DELETE"})).ok&&(i({title:"Success",description:"Expense deleted successfully"}),x())}catch{i({title:"Error",description:"Failed to delete expense",variant:"destructive"})}},F=async()=>{try{const t=parseFloat(s.amount);if(isNaN(t)){i({title:"Error",description:"Please enter a valid amount",variant:"destructive"});return}(await fetch("/api/financials/expenses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:s.category,amount:t,date:s.date,description:s.description})})).ok&&(i({title:"Success",description:"Expense added successfully"}),g(!1),n({id:"",category:"",amount:"",date:new Date().toISOString().split("T")[0],description:""}),x())}catch{i({title:"Error",description:"Failed to add expense",variant:"destructive"})}},T=async()=>{try{const t=parseFloat(s.amount);if(isNaN(t)){i({title:"Error",description:"Please enter a valid amount",variant:"destructive"});return}(await fetch(`/api/financials/expenses/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:s.category,amount:t,date:s.date,description:s.description})})).ok&&(i({title:"Success",description:"Expense updated successfully"}),m(!1),x())}catch{i({title:"Error",description:"Failed to update expense",variant:"destructive"})}},A=[{accessorKey:"category",header:"Category"},{accessorKey:"amount",header:"Amount",cell:({row:t})=>{if(!(t!=null&&t.original))return"₹0.00";const a=t.original.amount;return a!==void 0?`₹${Number(a).toFixed(2)}`:"₹0.00"}},{accessorKey:"date",header:"Date"},{accessorKey:"description",header:"Description"},{id:"actions",cell:({row:t})=>{if(!(t!=null&&t.original))return null;const a=t.original;return e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>b(a),className:"h-8 w-8 p-0",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),e.jsx("path",{d:"m15 5 4 4"})]})}),e.jsx(l,{variant:"destructive",size:"sm",onClick:()=>k(a.id),className:"h-8 w-8 p-0",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})})]})}}],O=h.reduce((t,a)=>t+Number(a.amount),0);return e.jsxs("div",{className:"container mx-auto py-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Expenses Overview"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold",children:["₹",O.toFixed(2)]})]}),e.jsxs(l,{className:"bg-white text-black hover:bg-black hover:text-white",onClick:()=>{n({id:"",category:"",amount:"",date:new Date().toISOString().split("T")[0],description:""}),g(!0)},children:[e.jsx(L,{className:"h-4 w-4 mr-2"})," Add Expense"]})]})]}),e.jsx("div",{className:"mb-4 bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Filter by Date Range"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Start:"}),e.jsx(r,{type:"date",value:c,onChange:t=>v(t.target.value),className:"w-auto"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"End:"}),e.jsx(r,{type:"date",value:d,onChange:t=>f(t.target.value),className:"w-auto"})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{v(""),f("")},children:"Clear"})]})]})}),e.jsx(y,{open:C,onOpenChange:g,children:e.jsxs(E,{children:[e.jsx(N,{children:e.jsx(w,{children:"Add Expense"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx(r,{placeholder:"Category",value:s.category,onChange:t=>n({...s,category:t.target.value})}),e.jsx(r,{type:"number",placeholder:"Amount",value:s.amount,onChange:t=>n({...s,amount:t.target.value})}),e.jsx(r,{type:"date",value:s.date,onChange:t=>n({...s,date:t.target.value})}),e.jsx(r,{placeholder:"Description",value:s.description,onChange:t=>n({...s,description:t.target.value})}),e.jsx(l,{onClick:F,children:"Add Expense"})]})]})}),e.jsx(y,{open:S,onOpenChange:m,children:e.jsxs(E,{children:[e.jsx(N,{children:e.jsx(w,{children:"Edit Expense"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsx(r,{placeholder:"Category",value:s.category,onChange:t=>n({...s,category:t.target.value})}),e.jsx(r,{type:"number",placeholder:"Amount",value:s.amount,onChange:t=>n({...s,amount:t.target.value})}),e.jsx(r,{type:"date",value:s.date,onChange:t=>n({...s,date:t.target.value})}),e.jsx(r,{placeholder:"Description",value:s.description,onChange:t=>n({...s,description:t.target.value})}),e.jsx(l,{onClick:T,children:"Update Expense"})]})]})}),p.length===0?e.jsx("div",{className:"text-center p-8 border rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No expenses found. Add your first expense!"})}):h.length===0?e.jsx("div",{className:"text-center p-8 border rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No expenses found in the selected date range."})}):e.jsx(I,{columns:A,data:h})]})}function z(){return e.jsx(M,{title:"Expenses",description:"Monitor and manage your expenses",children:e.jsx(B,{})})}export{z as default};
