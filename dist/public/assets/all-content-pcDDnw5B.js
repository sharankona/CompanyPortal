import{r as h,w as $,u as J,x as F,y as g,j as e,e as L,C as R,z as W,S as v,o as y,p as b,q as w,s as m,A as z,E as G,F as C,G as N,H,J as X,K as Y}from"./index-B7iLIyza.js";import{A as Z,a as _}from"./arrow-up-narrow-wide-8S7c1kUE.js";function ne(){var k;const[V,q]=h.useState("list"),[i,K]=h.useState("all"),[r,O]=h.useState("updatedAt"),[T,U]=h.useState("desc");document.title="All Content | Dashboard";const p=$(),{toast:c}=J(),{data:d,isLoading:u,error:S}=F({queryKey:["/api/content","all"],queryFn:async()=>{console.log("Fetching all content...");try{const t=await fetch("/api/content");if(t.ok){const n=await t.json();return console.log("Fetched content data:",n),n}console.log("Main endpoint failed, trying individual content types...");const a=["blog","instagram","linkedin","youtube","facebook","twitter","product"],s=[];for(const n of a)try{const l=await fetch(`/api/content?contentType=${n}`);if(l.ok){const D=await l.json();Array.isArray(D)&&s.push(...D)}}catch(l){console.warn(`Failed to fetch ${n} content:`,l)}return console.log("Fetched combined content data:",s),s}catch(t){throw console.error("Error fetching content:",t),t}}}),{data:E}=F({queryKey:["/api/workflows"],queryFn:async()=>{const t=await fetch("/api/workflows");if(!t.ok)throw new Error("Failed to fetch workflows");return t.json()}}),I=g({mutationFn:async({id:t,status:a,notes:s})=>{const n=await fetch(`/api/content/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,notes:s})});if(!n.ok){const l=await n.json();throw new Error(l.message||"Failed to update content")}return n.json()},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/content"]}),c({title:"Content Updated",description:"Content status has been updated successfully."})},onError:t=>{c({title:"Error",description:t.message,variant:"destructive"})}}),B=g({mutationFn:async({id:t,data:a})=>{const s=await fetch(`/api/content/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const n=await s.json();throw new Error(n.message||"Failed to edit content")}return s.json()},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/content"]}),c({title:"Content Updated",description:"Content has been updated successfully."})},onError:t=>{c({title:"Error",description:t.message,variant:"destructive"})}}),M=g({mutationFn:async t=>{const a=await fetch(`/api/content/${t}`,{method:"DELETE"});if(!a.ok){const s=await a.json();throw new Error(s.message||"Failed to delete content")}return a.json()},onSuccess:()=>{p.invalidateQueries({queryKey:["/api/content"]}),c({title:"Content Deleted",description:"Content has been deleted successfully."})},onError:t=>{c({title:"Error",description:t.message,variant:"destructive"})}}),x=(t,a,s)=>{I.mutate({id:t,status:a,notes:s})},j=(t,a)=>{B.mutate({id:t,data:a})},f=t=>{M.mutate(t)},P=()=>{if(!d)return[];let t=d;return i!=="all"&&(t=t.filter(a=>a.contentType===i)),t.sort((a,s)=>{let n=a[r],l=s[r];return(r==="createdAt"||r==="updatedAt"||r==="deadline")&&(n=new Date(n||0).getTime(),l=new Date(l||0).getTime()),typeof n=="string"&&(n=n.toLowerCase(),l=l.toLowerCase()),T==="asc"?n>l?1:-1:n<l?1:-1}),t},A=[{value:"all",label:"All Content Types"},{value:"blog",label:"Blog Posts"},{value:"instagram",label:"Instagram"},{value:"linkedin",label:"LinkedIn"},{value:"youtube",label:"YouTube"},{value:"facebook",label:"Facebook"},{value:"twitter",label:"X (Twitter)"},{value:"product",label:"Product Listings"}],Q=[{value:"updatedAt",label:"Last Updated"},{value:"createdAt",label:"Created Date"},{value:"title",label:"Title"},{value:"status",label:"Status"},{value:"contentType",label:"Content Type"},{value:"deadline",label:"Deadline"}],o=P();return S?e.jsx(L,{title:"All Content",description:"View and manage all content across platforms",children:e.jsxs("div",{className:"text-center p-8 text-red-600",children:["Error loading content: ",S.message]})}):e.jsx(L,{title:"All Content",description:"View and manage all content across platforms",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{children:e.jsxs(W,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Content Type"}),e.jsxs(v,{value:i,onValueChange:K,children:[e.jsx(y,{className:"w-[200px]",children:e.jsx(b,{placeholder:"Select content type"})}),e.jsx(w,{children:A.map(t=>e.jsx(m,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sort By"}),e.jsxs(v,{value:r,onValueChange:O,children:[e.jsx(y,{className:"w-[200px]",children:e.jsx(b,{placeholder:"Sort by"})}),e.jsx(w,{children:Q.map(t=>e.jsx(m,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sort Order"}),e.jsxs(v,{value:T,onValueChange:U,children:[e.jsx(y,{className:"w-[150px]",children:e.jsx(b,{placeholder:"Order"})}),e.jsxs(w,{children:[e.jsx(m,{value:"desc",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Descending"]})}),e.jsx(m,{value:"asc",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Ascending"]})})]})]})]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",o.length," ",o.length===1?"item":"items",i!=="all"&&e.jsxs("span",{children:[" for ",(k=A.find(t=>t.value===i))==null?void 0:k.label]}),u&&e.jsx("span",{children:" (Loading...)"}),d&&e.jsxs("span",{children:[" (Total available: ",d.length,")"]})]})]})}),e.jsxs(z,{value:V,onValueChange:q,className:"w-full",children:[e.jsxs(G,{className:"grid w-full grid-cols-3",children:[e.jsx(C,{value:"kanban",children:"Kanban Board"}),e.jsx(C,{value:"list",children:"List View"}),e.jsx(C,{value:"calendar",children:"Calendar"})]}),e.jsx(N,{value:"kanban",className:"mt-6",children:u?e.jsx("div",{className:"text-center p-8",children:"Loading content..."}):o.length===0?e.jsxs("div",{className:"text-center p-8 text-gray-500",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No content found"}),e.jsx("p",{children:"No content entries are available. Create some content in the individual content pages to see them here."})]}):e.jsx(H,{contentItems:o,onStatusChange:x,onEdit:j,onDelete:f,workflows:E})}),e.jsx(N,{value:"list",className:"mt-6",children:u?e.jsx("div",{className:"text-center p-8",children:"Loading content..."}):o.length===0?e.jsxs("div",{className:"text-center p-8 text-gray-500",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No content found"}),e.jsx("p",{children:"No content entries are available. Create some content in the individual content pages to see them here."})]}):e.jsx(X,{contentItems:o,onStatusChange:x,onEdit:j,onDelete:f,workflows:E})}),e.jsx(N,{value:"calendar",className:"mt-6",children:u?e.jsx("div",{className:"text-center p-8",children:"Loading content..."}):o.length===0?e.jsxs("div",{className:"text-center p-8 text-gray-500",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No content found"}),e.jsx("p",{children:"No content entries are available. Create some content in the individual content pages to see them here."})]}):e.jsx(Y,{contentItems:o,onStatusChange:x,onEdit:j,onDelete:f})})]})]})})}export{ne as default};
